STM32MP157 SOC
==============

My kit is the **STM32MP157F-DK2**.

**Arm ARCH**  - armv7-eabihf 
**Processor** - SMP Dual Cortex A7, AMP Cortex M4



Useful Links 
------------

https://wiki.st.com/stm32mpu/wiki/STM32CubeProgrammer_flashlayout#Field6-_Offset
https://wiki.st.com/stm32mpu/wiki/STM32CubeProgrammer
https://docs.kontron-electronics.de/sw/yocto/build-stm32mp/booting-an-image.html
https://wiki.st.com/stm32mpu/wiki/STM32_MPU_Flash_mapping
https://wiki.st.com/stm32mpu/wiki/Boot_chain_overview


U-boot
-------

The steps to build u-boot are:

1. Get a cross compiler

Many at:
https://toolchains.bootlin.com/

2. Export the cross compiler prefix in **CROSS-COMPILE** env variable

.. code-block:: console

    export CROSS-COMPILE=$CROSS_CC_PREFIX

My compilers prefix: 
**armv7-eabihf** - arm-buildroot-linux-gnueabihf

3. Set U-boot output build directory in **KBUILD_OUTPUT**

.. code-block:: console

    export KBUILD_OUTPUT=build/$BOARD


4. Configure U-boot 

Execute one of the commands 

.. code-block:: console

   make stm32mp15_defconfig 
   make stm32mp15_trusted_defconfig
   make stm32mp15_basic_defconfig 
     

5. Build

.. code-block:: console

   make all

6. Build with **BEAR** to generate **compile-commands.json** database

.. code-block:: console

   bear --use-cc $CROSS_CC_PREFIX-gcc make all   





